<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Green Thumb Garden Store</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Font Awesome for cart icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {  
            --primary-color: #4CAF50;
            --secondary-color: #8BC34A;
            --text-color: #333;
            --bg-color: #f5f5f5;
            --light-bg: #fff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
  
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            scroll-behavior: smooth;
        }

        /* --- Header & Navigation --- */
        header {
            background-color: var(--primary-color);
            color: #fff;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 600;
        }

        .nav-links {
            list-style: none;
            display: flex;
            align-items: center;
        }

        .nav-links a {
            color: #fff;
            text-decoration: none;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            background-color: var(--secondary-color);
            border-radius: 5px;
        }

        .menu-toggle {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
            background: none;
            border: none;
            color: #fff;
        }
        
        .cart-icon {
            font-size: 1.2rem;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: 0;
            background-color: red;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* --- Main Content --- */
        .section {
            padding: 4rem 2rem;
            background-color: var(--light-bg);
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        
        .section-dark {
            background-color: var(--secondary-color);
            color: #fff;
            text-align: center;
        }

        h2 {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }

        /* --- Home Section --- */
        #home {
            text-align: center;
            background: linear-gradient(rgba(76, 175, 80, 0.7), rgba(139, 195, 74, 0.7)), url('https://placehold.co/1920x1080/4CAF50/ffffff?text=Beautiful+Garden+Background') center/cover no-repeat;
            color: #fff;
            padding: 6rem 2rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
        }

        #home h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
        }
        
        #home p {
            font-size: 1.2rem;
            max-width: 600px;
        }

        .cta-button {
            display: inline-block;
            background-color: #fff;
            color: var(--primary-color);
            padding: 0.8rem 2rem;
            margin-top: 2rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .cta-button:hover {
            background-color: var(--primary-color);
            color: #fff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* --- Products Section --- */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            text-align: center;
        }

        .product-card {
            background-color: var(--light-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-10px);
        }

        .product-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-info h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .product-info p {
            margin-bottom: 1rem;
        }

        .buy-button {
            background-color: var(--primary-color);
            color: #fff;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .buy-button:hover {
            background-color: var(--secondary-color);
        }

        /* --- About & Contact Sections --- */
        #about, #contact {
            max-width: 800px;
            margin: 0 auto;
        }
        
        #contact .contact-info {
            text-align: center;
            margin-top: 2rem;
        }
        
        #contact .contact-info p {
            margin-bottom: 0.5rem;
        }

        /* --- Footer --- */
        footer {
            background-color: var(--primary-color);
            color: #fff;
            text-align: center;
            padding: 1rem;
        }

        /* --- Cart Modal --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--light-bg);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            width: 90%;
            max-width: 600px;
            position: relative;
        }

        .modal-content h2 {
            margin-top: 0;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2rem;
            font-weight: 600;
            color: #aaa;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: #333;
            text-decoration: none;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding: 1rem 0;
        }
        
        .cart-item-info {
            flex-grow: 1;
            margin-right: 1rem;
        }
        
        .cart-total {
            text-align: right;
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 1rem;
        }

        .primary-button {
            display: block;
            width: 100%;
            background-color: var(--primary-color);
            color: #fff;
            border: none;
            padding: 1rem;
            border-radius: 5px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1.5rem;
            transition: background-color 0.3s ease;
        }

        .primary-button:hover {
            background-color: var(--secondary-color);
        }

        /* --- Order Form Styles --- */
        .order-form input {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            header {
                flex-wrap: wrap;
            }

            .logo {
                width: 100%;
                text-align: center;
                margin-bottom: 1rem;
            }
            
            .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                text-align: center;
            }

            .nav-links.active {
                display: flex;
            }

            .nav-links a {
                padding: 1rem;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .nav-links li:last-child a {
                border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            }

            .menu-toggle {
                display: block;
            }
            
            .section {
                padding: 2rem 1rem;
            }
            
            h2 {
                font-size: 2rem;
            }
            
            #home h1 {
                font-size: 2.5rem;
            }
            
            #home p {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">The Green Thumb</div>
        <nav>
            <button class="menu-toggle" id="menu-toggle">&#9776;</button>
            <ul class="nav-links" id="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#products">Products</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact Us</a></li>
                <li>
                    <a href="#" id="cart-link">
                        <i class="fas fa-shopping-cart cart-icon"></i>
                        <span id="cart-count" class="cart-count">0</span>
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <!-- Home Section -->
        <section id="home" class="section">
            <h1>Welcome to Our Garden Store</h1>
            <p>Your one-stop shop for beautiful plants, quality seeds, and all your gardening needs. Start growing today!</p>
            <a href="#products" class="cta-button">Shop Now</a>
        </section>

        <!-- Products Section -->
        <section id="products" class="section">
            <h2>Our Products</h2>
            <div class="products-grid" id="products-container">
                <!-- Product cards will be dynamically inserted here by JavaScript -->
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="section">
            <h2>About Us</h2>
            <p>
                At The Green Thumb, we believe that gardening is more than just a hobby—it's a way of life.
                We started our journey with a simple passion for growing and nurturing plants. Our mission
                is to share that passion with you by providing the highest quality plants, seeds, and
                gardening tools. We source our products responsibly and are dedicated to helping you create
                your own little paradise, one plant at a time.
            </p>
        </section>

        <!-- Contact Us Section -->
        <section id="contact" class="section">
            <h2>Contact Us</h2>
            <p>Have a question or need assistance? Don't hesitate to reach out! We're here to help you with your gardening journey.</p>
            <div class="contact-info">
                <p>Email: <a href="mailto:info@greenthumb.com">info@greenthumb.com</a></p>
                <p>Phone: (123) 456-7890</p>
                <p>Address: 123 Garden Lane, Green Valley, GV 12345</p>
            </div>
        </section>
    </main>

    <!-- Cart Modal -->
    <div id="cart-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-cart">&times;</span>
            <h2>Your Cart</h2>
            <div id="cart-items-container">
                <!-- Cart items will be dynamically inserted here -->
            </div>
            <div id="cart-total" class="cart-total"></div>
            <button class="primary-button" id="order-button">Order Now</button>
        </div>
    </div>
    
    <!-- User Details Modal -->
    <div id="user-details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-details-modal">&times;</span>
            <h2>Enter Your Details</h2>
            <form id="order-form" class="order-form">
                <input type="text" id="user-name" placeholder="Full Name" required>
                <input type="email" id="user-email" placeholder="Email Address" required>
                <input type="text" id="user-address" placeholder="Shipping Address" required>
                <button type="submit" class="primary-button">Complete Order</button>
            </form>
        </div>
    </div>

    <footer>
        <p>&copy; 2024 The Green Thumb. All Rights Reserved.</p>
    </footer>

    <script>
        // --- Data (JSON) for products ---
        const storeData = {
            products: [
                { id: 1, name: "Rose Bush", description: "A beautiful red rose bush, perfect for any garden.", price: 25.00, imageUrl: "https://placehold.co/600x400/8BC34A/ffffff?text=Rose+Bush", type: "plant" },
                { id: 2, name: "Sunflower Seeds", description: "Grow your own giant sunflowers with these premium seeds.", price: 3.50, imageUrl: "https://placehold.co/600x400/4CAF50/ffffff?text=Sunflower+Seeds", type: "seed" },
                { id: 3, name: "Succulent Collection", description: "A beautiful assortment of easy-to-care-for succulents.", price: 30.00, imageUrl: "https://placehold.co/600x400/6A89CC/ffffff?text=Succulent+Collection", type: "plant" },
                { id: 4, name: "Tomato Seeds", description: "Heirloom tomato seeds for a bountiful harvest.", price: 4.00, imageUrl: "https://placehold.co/600x400/D4E157/ffffff?text=Tomato+Seeds", type: "seed" },
                { id: 5, name: "Lavender Plant", description: "A fragrant lavender plant to attract pollinators.", price: 15.00, imageUrl: "https://placehold.co/600x400/9575CD/ffffff?text=Lavender+Plant", type: "plant" },
                { id: 6, name: "Herb Garden Kit", description: "A starter kit with basil, mint, and rosemary seeds.", price: 20.00, imageUrl: "https://placehold.co/600x400/A1887F/ffffff?text=Herb+Garden+Kit", type: "seed" },
            ]
        };

        let cart = []; // The cart array to hold products and quantities
        const recipientEmail = 'nasihkp0271@gmail.com'; // Your email address

        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Element Selection ---
            const productsContainer = document.getElementById('products-container');
            const navLinks = document.getElementById('nav-links');
            const menuToggle = document.getElementById('menu-toggle');
            const cartLink = document.getElementById('cart-link');
            const cartModal = document.getElementById('cart-modal');
            const closeCartBtn = document.getElementById('close-cart');
            const cartCountSpan = document.getElementById('cart-count');
            const cartItemsContainer = document.getElementById('cart-items-container');
            const cartTotalDiv = document.getElementById('cart-total');
            const orderButton = document.getElementById('order-button');
            const userDetailsModal = document.getElementById('user-details-modal');
            const closeDetailsModalBtn = document.getElementById('close-details-modal');
            const orderForm = document.getElementById('order-form');

            // --- Function to render products ---
            const renderProducts = () => {
                productsContainer.innerHTML = ''; // Clear previous content
                storeData.products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.classList.add('product-card');
                    productCard.innerHTML = `
                        <img src="${product.imageUrl}" alt="${product.name}">
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p>${product.description}</p>
                            <p><strong>$${product.price.toFixed(2)}</strong></p>
                            <button class="buy-button" data-id="${product.id}">Add to Cart</button>
                        </div>
                    `;
                    productsContainer.appendChild(productCard);
                });

                // Attach event listeners to all new "Add to Cart" buttons
                document.querySelectorAll('.buy-button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.dataset.id);
                        const productToAdd = storeData.products.find(p => p.id === productId);
                        addToCart(productToAdd);
                    });
                });
            };

            // --- Cart functionality ---
            const updateCartCount = () => {
                const totalItems = cart.reduce((acc, item) => acc + item.quantity, 0);
                cartCountSpan.textContent = totalItems;
            };

            const addToCart = (product) => {
                const existingItem = cart.find(item => item.id === product.id);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                updateCartCount();
                alert(`${product.name} added to cart! Total items: ${cart.reduce((acc, item) => acc + item.quantity, 0)}`);
            };

            const renderCart = () => {
                cartItemsContainer.innerHTML = '';
                if (cart.length === 0) {
                    cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
                    cartTotalDiv.textContent = `$0.00`;
                    return;
                }

                let total = 0;
                cart.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.classList.add('cart-item');
                    const subtotal = item.price * item.quantity;
                    total += subtotal;

                    itemElement.innerHTML = `
                        <div class="cart-item-info">
                            <h4>${item.name}</h4>
                            <p>$${item.price.toFixed(2)} x ${item.quantity}</p>
                        </div>
                        <div class="cart-item-controls">
                            <span>$${subtotal.toFixed(2)}</span>
                        </div>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                });

                cartTotalDiv.textContent = `Total: $${total.toFixed(2)}`;
            };
            
            // --- Event Listeners ---
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
            });

            navLinks.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.classList.remove('active');
                });
            });

            cartLink.addEventListener('click', (e) => {
                e.preventDefault();
                cartModal.style.display = 'flex';
                renderCart();
            });

            closeCartBtn.addEventListener('click', () => {
                cartModal.style.display = 'none';
            });
            
            closeDetailsModalBtn.addEventListener('click', () => {
                userDetailsModal.style.display = 'none';
            });

            window.addEventListener('click', (e) => {
                if (e.target === cartModal) {
                    cartModal.style.display = 'none';
                }
                if (e.target === userDetailsModal) {
                    userDetailsModal.style.display = 'none';
                }
            });

            orderButton.addEventListener('click', () => {
                if (cart.length > 0) {
                    cartModal.style.display = 'none';
                    userDetailsModal.style.display = 'flex';
                } else {
                    alert('Your cart is empty. Please add items before ordering.');
                }
            });
            
            orderForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const userName = document.getElementById('user-name').value;
                const userEmail = document.getElementById('user-email').value;
                const userAddress = document.getElementById('user-address').value;
                
                // --- Start of new email sending logic ---
                try {
                    const response = await fetch('/api/send-email', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            userName,
                            userEmail,
                            userAddress,
                            cart,
                        }),
                    });

                    if (response.ok) {
                        alert('Order placed successfully! An email has been sent with the details.');
                    } else {
                        throw new Error('Failed to send order email.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('There was an error placing your order. Please try again.');
                }
                
                // --- End of new email sending logic ---

                // Clear the cart and reset the form
                cart = [];
                updateCartCount();
                orderForm.reset();
                userDetailsModal.style.display = 'none';
            });

            // --- Initial render of content on page load ---
            renderProducts();
            updateCartCount(); // Initialize cart count
        });
    </script>

</body>
</html>
